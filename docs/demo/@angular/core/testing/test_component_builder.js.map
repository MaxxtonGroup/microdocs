{"version":3,"file":"test_component_builder.js","sourceRoot":"","sources":["../../../../modules/@angular/core/testing/test_component_builder.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {AnimationEntryMetadata, Compiler, ComponentFactory, Injectable, Injector, NgZone, OpaqueToken, ViewMetadata} from '../index';\nimport {PromiseWrapper} from '../src/facade/async';\nimport {ConcreteType, IS_DART, Type, isPresent} from '../src/facade/lang';\n\nimport {ComponentFixture} from './component_fixture';\nimport {tick} from './fake_async';\n\n\n\n/**\n * An abstract class for inserting the root test component element in a platform independent way.\n *\n * @experimental\n */\nexport class TestComponentRenderer {\n  insertRootElement(rootElementId: string) {}\n}\n\n/**\n * @experimental\n */\nexport var ComponentFixtureAutoDetect = new OpaqueToken('ComponentFixtureAutoDetect');\n\n/**\n * @experimental\n */\nexport var ComponentFixtureNoNgZone = new OpaqueToken('ComponentFixtureNoNgZone');\n\nvar _nextRootElementId = 0;\nexport class TestComponentBuilder {\n  constructor(protected _injector: Injector) {}\n\n  /**\n   * Overrides only the html of a {@link ComponentMetadata}.\n   * All the other properties of the component's {@link ViewMetadata} are preserved.\n   */\n  overrideTemplate(componentType: Type, template: string): TestComponentBuilder {\n    throw new Error(\n        'overrideTemplate is not supported in this implementation of TestComponentBuilder.');\n  }\n\n  /**\n   * Overrides a component's {@link ViewMetadata}.\n   */\n  overrideView(componentType: Type, view: ViewMetadata): TestComponentBuilder {\n    throw new Error(\n        'overrideView is not supported in this implementation of TestComponentBuilder.');\n  }\n\n  /**\n   * Overrides the directives from the component {@link ViewMetadata}.\n   */\n  overrideDirective(componentType: Type, from: Type, to: Type): TestComponentBuilder {\n    throw new Error(\n        'overrideDirective is not supported in this implementation of TestComponentBuilder.');\n  }\n\n  /**\n   * Overrides one or more injectables configured via `providers` metadata property of a directive\n   * or\n   * component.\n   * Very useful when certain providers need to be mocked out.\n   *\n   * The providers specified via this method are appended to the existing `providers` causing the\n   * duplicated providers to\n   * be overridden.\n   */\n  overrideProviders(type: Type, providers: any[]): TestComponentBuilder {\n    throw new Error(\n        'overrideProviders is not supported in this implementation of TestComponentBuilder.');\n  }\n\n  /**\n   * Overrides one or more injectables configured via `providers` metadata property of a directive\n   * or\n   * component.\n   * Very useful when certain providers need to be mocked out.\n   *\n   * The providers specified via this method are appended to the existing `providers` causing the\n   * duplicated providers to\n   * be overridden.\n   */\n  overrideViewProviders(type: Type, providers: any[]): TestComponentBuilder {\n    throw new Error(\n        'overrideViewProviders is not supported in this implementation of TestComponentBuilder.');\n  }\n\n  overrideAnimations(componentType: Type, animations: AnimationEntryMetadata[]):\n      TestComponentBuilder {\n    throw new Error(\n        'overrideAnimations is not supported in this implementation of TestComponentBuilder.');\n  }\n\n  protected createFromFactory<C>(ngZone: NgZone, componentFactory: ComponentFactory<C>):\n      ComponentFixture<C> {\n    let rootElId = `root${_nextRootElementId++}`;\n    var testComponentRenderer: TestComponentRenderer = this._injector.get(TestComponentRenderer);\n    testComponentRenderer.insertRootElement(rootElId);\n\n    var componentRef = componentFactory.create(this._injector, [], `#${rootElId}`);\n    let autoDetect: boolean = this._injector.get(ComponentFixtureAutoDetect, false);\n    return new ComponentFixture<any /*C*/>(componentRef, ngZone, autoDetect);\n  }\n\n  /**\n   * Builds and returns a ComponentFixture.\n   */\n  createAsync<T>(rootComponentType: ConcreteType<T>): Promise<ComponentFixture<T>> {\n    let noNgZone = IS_DART || this._injector.get(ComponentFixtureNoNgZone, false);\n    let ngZone: NgZone = noNgZone ? null : this._injector.get(NgZone, null);\n    let compiler: Compiler = this._injector.get(Compiler);\n\n    let initComponent = () => {\n      let promise: Promise<ComponentFactory<any>> =\n          compiler.compileComponentAsync(rootComponentType);\n      return promise.then(componentFactory => this.createFromFactory(ngZone, componentFactory));\n    };\n\n    return ngZone == null ? initComponent() : ngZone.run(initComponent);\n  }\n\n  createFakeAsync<T>(rootComponentType: ConcreteType<T>): ComponentFixture<T> {\n    let result: any /** TODO #9100 */;\n    let error: any /** TODO #9100 */;\n    PromiseWrapper.then(\n        this.createAsync(rootComponentType), (_result) => { result = _result; },\n        (_error) => { error = _error; });\n    tick();\n    if (isPresent(error)) {\n      throw error;\n    }\n    return result;\n  }\n\n  createSync<T>(rootComponentType: ConcreteType<T>): ComponentFixture<T> {\n    let noNgZone = IS_DART || this._injector.get(ComponentFixtureNoNgZone, false);\n    let ngZone: NgZone = noNgZone ? null : this._injector.get(NgZone, null);\n    let compiler: Compiler = this._injector.get(Compiler);\n\n    let initComponent = () => {\n      return this.createFromFactory(\n          ngZone, this._injector.get(Compiler).compileComponentSync(rootComponentType));\n    };\n\n    return ngZone == null ? initComponent() : ngZone.run(initComponent);\n  }\n/** @nocollapse */\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n{type: Injector, },\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}